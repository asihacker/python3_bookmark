#!/usr/bin/python
# coding=utf-8
import nsq
import tornado.ioloop
import time


def pub_message():
    a = """{"code":1,"type":"FriendingCometPYMKPanelPaginationQuery","taskId":1144,"msg":{"success":true,"data":{"viewer":{"people_you_may_know":{"tracking_signature":"1761623168","edges":[{"node":{"id":"100015374830627","friendship_status":"CAN_REQUEST","name":"刘祯亮","url":"https:\/\/www.facebook.com\/profile.php?id=100015374830627","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/119172609_941274536395032_2834988040921735388_n.jpg?_nc_cat=108&_nc_sid=7206a8&_nc_ohc=awXMl-KTf1YAX8AhvIc&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=170d969c84be6b3b0a1e68d5407829c9&oe=5FA99F72"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100044414802355","friendship_status":"CAN_REQUEST","name":"犬塚弘一","url":"https:\/\/www.facebook.com\/profile.php?id=100044414802355","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/120954982_206911644132661_4155651688418189844_o.jpg?_nc_cat=106&_nc_sid=7206a8&_nc_ohc=_9vfc08cmygAX_o1KOa&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=f5df6d1823b24c7603d15b82f8ed6c87&oe=5FAAC47F"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100051455514354","friendship_status":"CAN_REQUEST","name":"佐竹 ひろし","url":"https:\/\/www.facebook.com\/profile.php?id=100051455514354","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.30497-1\/c35.0.120.120a\/p120x120\/84241059_189132118950875_4138507100605120512_n.jpg?_nc_cat=1&_nc_sid=7206a8&_nc_ohc=rf0c5sOmIdkAX9xp_rg&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=adafec13fdf53fd53f768e70adcff529&oe=5FAAE0E5"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100056242210274","friendship_status":"CAN_REQUEST","name":"神尾龍泉","url":"https:\/\/www.facebook.com\/profile.php?id=100056242210274","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c3.0.120.120a\/p120x120\/121048579_104544018097005_8191005595334481699_n.jpg?_nc_cat=105&_nc_sid=7206a8&_nc_ohc=imcFVSqXUFUAX-BR2NG&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=45ab5a55557e56232fd7a9a979592806&oe=5FA96B38"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100054353922648","friendship_status":"CAN_REQUEST","name":"村山貴祥","url":"https:\/\/www.facebook.com\/profile.php?id=100054353922648","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c0.8.120.120a\/p120x120\/118232865_110690604086070_4691906012257249367_o.jpg?_nc_cat=100&_nc_sid=7206a8&_nc_ohc=AIut1Sh0njoAX-SzJpV&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=6fde2c3edf55dc5f1bc360184b2b5bb9&oe=5FAA5A66"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100042536647949","friendship_status":"CAN_REQUEST","name":"Hanumata Hanumta","url":"https:\/\/www.facebook.com\/hanumata.hanumta.7","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c0.0.120.120a\/p120x120\/73026059_103569717737583_1760069390218297344_o.jpg?_nc_cat=101&_nc_sid=7206a8&_nc_ohc=DzWQX3UB4QYAX8aYGcA&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=f2133777f862808f530fe9e31361925b&oe=5FAAF447"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100056114753175","friendship_status":"CAN_REQUEST","name":"Yaxye Galiye","url":"https:\/\/www.facebook.com\/yaxye.galiye","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/121506048_110656187481539_912214505677987265_o.jpg?_nc_cat=108&_nc_sid=7206a8&_nc_ohc=IQGZ2cp8-bQAX-Fs4G2&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=cd872ec9adb3b72fc59fc2bf498d22ac&oe=5FABF6CC"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100055091689087","friendship_status":"CAN_REQUEST","name":"山本正勝","url":"https:\/\/www.facebook.com\/profile.php?id=100055091689087","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c60.0.120.120a\/p120x120\/119447804_117926826720373_361199772468670373_o.jpg?_nc_cat=100&_nc_sid=7206a8&_nc_ohc=9GTfcnPL6qcAX-qWy8F&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=cbb5cd92dc41da1e5c3b6dbcfd4fa2be&oe=5FAB0B8A"},"__isFriendNode":"User","social_context":{"text":"3 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100051659597634","friendship_status":"CAN_REQUEST","name":"Robbie Kams","url":"https:\/\/www.facebook.com\/robbie.kams.33","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c0.0.120.120a\/p120x120\/100803529_109295190802467_877743108865916928_o.jpg?_nc_cat=107&_nc_sid=7206a8&_nc_ohc=qO_CgUTYIZEAX89qMPX&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=c97dd65215cc174bc76ff7633f04571e&oe=5FABA28E"},"__isFriendNode":"User","social_context":{"text":"4 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100055960534256","friendship_status":"CAN_REQUEST","name":"藤村 サトシ","url":"https:\/\/www.facebook.com\/profile.php?id=100055960534256","profile_picture":{"uri":"https:\/\/scontent-hkg4-2.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/121326918_124965639378787_1611526919416130113_n.jpg?_nc_cat=104&_nc_sid=7206a8&_nc_ohc=nd-o_j4M5-wAX-3gW74&_nc_ht=scontent-hkg4-2.xx&tp=6&oh=62b6d7ca994f94d75a3b3969430a6bec&oe=5FABDBD2"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100041811637205","friendship_status":"CAN_REQUEST","name":"柳田久夫","url":"https:\/\/www.facebook.com\/profile.php?id=100041811637205","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/117434830_351458839591168_6411622016028789709_n.jpg?_nc_cat=110&_nc_sid=7206a8&_nc_ohc=zc7jGWLZtoEAX_r6WHs&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=6166b71e102f7f6d4adc3703b928471e&oe=5FA9F395"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100045957196627","friendship_status":"CAN_REQUEST","name":"Vicky Gbr","url":"https:\/\/www.facebook.com\/profile.php?id=100045957196627","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/121262952_207281084147130_6945432797341596267_n.jpg?_nc_cat=106&_nc_sid=7206a8&_nc_ohc=MTZq6hzB2iAAX_Ey30U&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=8dbe580d874195845d96c8b489e4818b&oe=5FAAD034"},"__isFriendNode":"User","social_context":{"text":"8 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100054866345301","friendship_status":"CAN_REQUEST","name":"鹿志村誠","url":"https:\/\/www.facebook.com\/profile.php?id=100054866345301","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/118517243_101429851695893_1809541066951519190_n.jpg?_nc_cat=105&_nc_sid=7206a8&_nc_ohc=5YQimSDOqz0AX-NPLHq&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=f697f1908665f59dba451779c00b8fba&oe=5FAA363F"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100010646621502","friendship_status":"CAN_REQUEST","name":"大友翔","url":"https:\/\/www.facebook.com\/profile.php?id=100010646621502","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/118331423_1192021634496046_5156556833726207981_n.jpg?_nc_cat=100&_nc_sid=7206a8&_nc_ohc=JNKebdl2rHkAX8CRTXi&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=08515eb2da7052677e7a362b56a458d8&oe=5FAB8CC9"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100036922242518","friendship_status":"CAN_REQUEST","name":"??? ??????????","url":"https:\/\/www.facebook.com\/profile.php?id=100036922242518","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c0.24.120.120a\/p120x120\/120895623_343713520202720_6165703282627326371_o.jpg?_nc_cat=108&_nc_sid=7206a8&_nc_ohc=ciiLaaXtf2sAX-q5Bp0&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=b4d8712d6a517e76a14ead7c7dc7d098&oe=5FA92DD0"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100051727314043","friendship_status":"CAN_REQUEST","name":"藤本拓巳","url":"https:\/\/www.facebook.com\/profile.php?id=100051727314043","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.30497-1\/c35.0.120.120a\/p120x120\/84241059_189132118950875_4138507100605120512_n.jpg?_nc_cat=1&_nc_sid=7206a8&_nc_ohc=rf0c5sOmIdkAX9xp_rg&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=adafec13fdf53fd53f768e70adcff529&oe=5FAAE0E5"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100055676057050","friendship_status":"CAN_REQUEST","name":"Kenshin Soda","url":"https:\/\/www.facebook.com\/kenshin.soda.3","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/120344998_107828997749635_474246937170604891_o.jpg?_nc_cat=102&_nc_sid=7206a8&_nc_ohc=Cj3_Fo_selYAX-amHru&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=3190ec013a386f05ce8f568846ba86c0&oe=5FACF25B"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100007107848866","friendship_status":"CAN_REQUEST","name":"Moon Saber","url":"https:\/\/www.facebook.com\/profile.php?id=100007107848866","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/10407964_1570551456525101_6862264005035786791_n.jpg?_nc_cat=102&_nc_sid=7206a8&_nc_ohc=3gCCk9uNRtYAX-FrZca&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=4796691aa5c4371954aba91bb5ccaa05&oe=5FAB8ADB"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100012858670100","friendship_status":"CAN_REQUEST","name":"サッカー 小僧","url":"https:\/\/www.facebook.com\/profile.php?id=100012858670100","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/p120x120\/121011378_1036367856801827_1557035845180956751_o.jpg?_nc_cat=107&_nc_sid=7206a8&_nc_ohc=KetLFeVhjbUAX8CB8gP&_nc_ht=scontent-hkg4-1.xx&tp=6&oh=98bda15df72a77529da89bf25c6cd0a9&oe=5FAC631F"},"__isFriendNode":"User","social_context":{"text":"1 位共同好友"},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null},{"node":{"id":"100055198855405","friendship_status":"CAN_REQUEST","name":"松田孝平","url":"https:\/\/www.facebook.com\/profile.php?id=100055198855405","profile_picture":{"uri":"https:\/\/scontent-hkg4-1.xx.fbcdn.net\/v\/t1.0-1\/c47.0.120.120a\/p120x120\/120781600_133047901878504_2949128481900897257_n.jpg?_nc_cat=109&_nc_sid=7206a8&_nc_ohc=G6A_49g-0fQAX-0OiMm&_nc_ht=scontent-hkg4-1.xx&_nc_tp=27&oh=8e0034749299173f57e675a46b5268a6&oe=5FAA1D4D"},"__isFriendNode":"User","social_context":{"text":""},"social_context_top_mutual_friends":[],"__typename":"User"},"cursor":null}],"page_info":{"has_next_page":true,"end_cursor":"0d12d60a09aa6853a8ee1dbc8465eed0"}}}}}}"""
    a = a.encode('utf-8')
    writer.pub('test',a , finish_pub)


def finish_pub(conn, data):
    print(conn,data)


# writer = nsq.Writer(['nsq.fqwang.net:4150'])
writer = nsq.Writer(['161.117.252.224:4150'])
tornado.ioloop.PeriodicCallback(pub_message, 3000).start()
nsq.run()
